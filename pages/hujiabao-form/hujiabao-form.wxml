<wxs module="wxsUtil">
    function formatDateTime (str) {
      return str.replace('T', ' ').replace('Z', ' ')
    }
    module.exports = {
        formatDateTime: formatDateTime
    }
</wxs>
<view class="page">
    <view class="page__bd">
        <view class="weui-cells__title">保单信息</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">工单状态</view>
                </view>
                <view class="weui-cell__bd">
                    <text class="weui-input readonly">{{statusMap[PolicyInfo.State] || '-'}}</text>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">保单号</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" bindinput="inputChange" data-name='PolicyInfo.PolicyNo'
                           value="{{PolicyInfo.PolicyNo}}" placeholder="保单号"/>
                </view>
            </view>
            <view class="weui-cell weui-cell_select">
                <view class="weui-cell__hd weui-cell__hd_in-select-after">
                    <view class="weui-label">产品类型</view>
                </view>
                <view class="weui-cell__bd">
                    <picker bindchange="pickerChange"
                            data-vname="PolicyInfo.ProductType"
                            data-lname="delayReportReason"
                            range="{{[]}}"
                            value="{{PolicyInfo.ProductType.index}}">
                        <view class="picker weui-select weui-select_in-select-after">
                            {{PolicyInfo.ProductType.label || '请选择'}}
                        </view>
                    </picker>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">保险起期</view>
                </view>
                <view class="weui-cell__bd">
                    <view class="weui-cell__bd">
                        <view class="picker weui-select weui-select_in-select-after"
                              data-value="{{PolicyInfo.EffectiveDate}}"
                              data-name="PolicyInfo.EffectiveDate"
                              bindtap="openDatePickerPopup">
                            {{PolicyInfo.EffectiveDate ? wxsUtil.formatDateTime(PolicyInfo.EffectiveDate) : '请选择'}}
                        </view>
                    </view>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">保险止期</view>
                </view>
                <view class="weui-cell__bd">
                    <view class="weui-cell__bd">
                        <view class="picker weui-select weui-select_in-select-after"
                              data-value="{{PolicyInfo.ExpireDate}}"
                              data-name="PolicyInfo.ExpireDate"
                              bindtap="openDatePickerPopup">
                            {{PolicyInfo.ExpireDate ? wxsUtil.formatDateTime(PolicyInfo.ExpireDate) : '请选择'}}
                        </view>
                    </view>
                </view>
            </view>
            <view class="weui-cell weui-cell_select">
                <view class="weui-cell__hd weui-cell__hd_in-select-after">
                    <view class="weui-label">保单状态</view>
                </view>
                <view class="weui-cell__bd">
                    <picker bindchange="pickerChange"
                            data-vname="PolicyInfo.PolicyStatus"
                            data-lname="status"
                            range="{{statusList}}"
                            value="{{PolicyInfo.PolicyStatus.index}}">
                        <view class="picker weui-select weui-select_in-select-after">
                            {{PolicyInfo.PolicyStatus.label || '请选择'}}
                        </view>
                    </picker>
                </view>
            </view>

            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">签单保费</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" type="number" bindinput="inputChange" data-name="PolicyInfo.StandardPremium"
                           value="{{PolicyInfo.StandardPremium}}" placeholder="签单保费"/>
                </view>
            </view>
        </view>

        <view class="page__bd">
            <view class="weui-cells__title">房屋标的信息</view>
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">房屋所在</view>
                    </view>
                    <view class="weui-cell__bd">
                        <view class="weui-cell__bd">
                            <view class="picker weui-select weui-select_in-select-after"
                                  data-name="PolicyInfo.Property.Property"
                                  data-value="{{PolicyInfo.Property.PropertyDistrict}}"
                                  bindtap="openAreaPopup">
                                {{PolicyInfo.Property.PropertyLabel ? PolicyInfo.Property.PropertyLabel : '请填写地址'}}
                            </view>
                        </view>
                    </view>
                </view>

                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">房屋详细地址</view>
                    </view>
                    <view class="weui-cell__bd">
                        <input class="weui-input" type="number" bindinput="inputChange" data-name="PolicyInfo.Property.PropertyDetailAddress"
                               value="{{PolicyInfo.Property.PropertyDetailAddress}}" placeholder="房屋详细地址"/>
                    </view>
                </view>
                <view style="border: 10px solid #f8f8f8; border-bottom: none;">
                    <view style="border-bottom: 10px solid #f8f8f8;" class="hujiabao-sub-title-wrap">
                        <view class="hujiabao-sub-title">
                            - 险别信息
                        </view>
                        <view>
                            <van-button bind:tap="addList"
                                        data-name="PolicyInfo.Property.CoverageList"
                                        data-current="{{PolicyInfo.Property.CoverageList}}"
                                        data-default="{{DefaultValue.Property.CoverageList[0]}}"
                                        icon="plus" type="primary" size="mini" />
                        </view>
                    </view>
                    <view class="hujiabao-list-bb10" wx:for="{{PolicyInfo.Property.CoverageList}}" wx:for-item="CoverageItem">
                        <view class="weui-cell weui-cell_select">
                            <view class="weui-cell__hd weui-cell__hd_in-select-after">
                                <view class="weui-label">是否最后一级</view>
                            </view>
                            <view class="weui-cell__bd">
                                <picker bindchange="pickerChange"
                                        data-vname="{{'PolicyInfo.Property.CoverageList['+index+'].IsFinalLevelCt'}}"
                                        data-lname="isCode"
                                        range="{{isCodeList}}"
                                        value="{{CoverageItem.IsFinalLevelCt.index}}">
                                    <view class="picker weui-select weui-select_in-select-after">
                                        {{CoverageItem.IsFinalLevelCt.label || '请选择'}}
                                    </view>
                                </picker>
                            </view>
                        </view>
                        <view class="weui-cell weui-cell_select">
                            <view class="weui-cell__hd weui-cell__hd_in-select-after">
                                <view class="weui-label">险别代码</view>
                            </view>
                            <view class="weui-cell__bd">
                                <picker bindchange="pickerChange"
                                        data-vname="{{'PolicyInfo.Property.CoverageList['+index+'].CoverageCode'}}"
                                        data-lname=""
                                        range="{{[]}}"
                                        value="{{CoverageItem.CoverageCode.index}}">
                                    <view class="picker weui-select weui-select_in-select-after">
                                        {{CoverageItem.CoverageCode.label || '请选择'}}
                                    </view>
                                </picker>
                            </view>
                        </view>
                        <view class="weui-cell weui-cell_input weui-cell_vcode">
                            <view class="weui-cell__hd">
                                <view class="weui-label">保额</view>
                            </view>
                            <view class="weui-cell__bd">
                                <input class="weui-input" bindinput="inputChange" data-name="{{'PolicyInfo.Property.CoverageList['+index+'].SumInsured'}}"
                                       value="{{CoverageItem.SumInsured}}" placeholder="保额"/>
                            </view>
                        </view>
                        <view class="weui-cell weui-cell_input weui-cell_vcode">
                            <view class="weui-cell__hd">
                                <view class="weui-label">历史预估金额</view>
                            </view>
                            <view class="weui-cell__bd">
                                <input class="weui-input" bindinput="inputChange" data-name="{{'PolicyInfo.Property.CoverageList['+index+'].SumPaymentAmt'}}"
                                       value="{{CoverageItem.SumPaymentAmt}}" placeholder="历史案件预估金额"/>
                            </view>
                        </view>

                        <view>
                            <view style="border-top: 5px solid #f8f8f8;" class="hujiabao-sub-title-wrap">
                                <view class="hujiabao-sub-title">
                                    -- 责任信息
                                </view>
                                <view>
                                    <van-button
                                      bind:tap="addList"
                                      data-name="{{'PolicyInfo.Property.CoverageList['+index+'].BenefitList'}}"
                                      data-current="{{PolicyInfo.Property.CoverageList[index].BenefitList}}"
                                      data-default="{{DefaultValue.Property.CoverageList[0].BenefitList[0]}}"
                                      icon="plus" type="primary" size="mini" />
                                </view>
                            </view>
                            <view style="border-bottom: 2px #f8f8f8 dashed;" wx:for="{{PolicyInfo.Property.CoverageList[index].BenefitList}}" wx:for-item="BenefitItem" wx:for-index="bIndex">
                                <view class="weui-cell weui-cell_select">
                                    <view class="weui-cell__hd weui-cell__hd_in-select-after">
                                        <view class="weui-label">是否最后一级</view>
                                    </view>
                                    <view class="weui-cell__bd">
                                        <picker bindchange="pickerChange"
                                                data-vname="{{'PolicyInfo.Property.CoverageList['+index+'].BenefitList['+bIndex+'].IsFinalLevelCt'}}"
                                                data-lname="isCode"
                                                range="{{isCodeList}}"
                                                value="{{BenefitItem.IsFinalLevelCt.index}}">
                                            <view class="picker weui-select weui-select_in-select-after">
                                                {{BenefitItem.IsFinalLevelCt.label || '请选择'}}
                                            </view>
                                        </picker>
                                    </view>
                                </view>
                                <view class="weui-cell weui-cell_select">
                                    <view class="weui-cell__hd weui-cell__hd_in-select-after">
                                        <view class="weui-label">险别代码</view>
                                    </view>
                                    <view class="weui-cell__bd">
                                        <picker bindchange="pickerChange"
                                                data-vname="{{'PolicyInfo.Property.CoverageList['+index+'].BenefitList['+bIndex+'].CoverageCode'}}"
                                                data-lname=""
                                                range="{{[]}}"
                                                value="{{BenefitItem.CoverageCode.index}}">
                                            <view class="picker weui-select weui-select_in-select-after">
                                                {{BenefitItem.CoverageCode.label || '请选择'}}
                                            </view>
                                        </picker>
                                    </view>
                                </view>
                                <view class="weui-cell weui-cell_input weui-cell_vcode">
                                    <view class="weui-cell__hd">
                                        <view class="weui-label">保额</view>
                                    </view>
                                    <view class="weui-cell__bd">
                                        <input class="weui-input" bindinput="inputChange" data-name="{{'PolicyInfo.Property.CoverageList['+index+'].BenefitList['+bIndex+'].SumInsured'}}"
                                               value="{{BenefitItem.SumInsured}}" placeholder="保额"/>
                                    </view>
                                </view>
                                <view class="weui-cell weui-cell_input weui-cell_vcode">
                                    <view class="weui-cell__hd">
                                        <view class="weui-label">历史预估金额</view>
                                    </view>
                                    <view class="weui-cell__bd">
                                        <input class="weui-input" bindinput="inputChange" data-name="{{'PolicyInfo.Property.CoverageList['+index+'].BenefitList['+bIndex+'].SumPaymentAmt'}}"
                                               value="{{BenefitItem.SumPaymentAmt}}" placeholder="历史案件预估金额"/>
                                    </view>
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>

            <view class="weui-cells__title">案件信息</view>
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">理赔编号</view>
                    </view>
                    <view class="weui-cell__bd">
                        <input class="weui-input" type="number" bindinput="inputChange" data-name="PolicyInfo.ClaimInfo.ClaimNo"
                               value="{{PolicyInfo.ClaimInfo.ClaimNo}}" placeholder="理赔编号"/>
                    </view>
                </view>

                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">出险时间</view>
                    </view>
                    <view class="weui-cell__bd">
                        <view class="weui-cell__bd">
                            <view class="picker weui-select weui-select_in-select-after"
                                  data-value="{{PolicyInfo.ClaimInfo.AccidentTime}}"
                                  data-name="PolicyInfo.ClaimInfo.AccidentTime"
                                  bindtap="openDatePickerPopup">
                                {{PolicyInfo.ClaimInfo.AccidentTime ? wxsUtil.formatDateTime(PolicyInfo.ClaimInfo.AccidentTime) : '请选择'}}
                            </view>
                        </view>
                    </view>
                </view>

                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">报案时间</view>
                    </view>
                    <view class="weui-cell__bd">
                        <view class="weui-cell__bd">
                            <view class="picker weui-select weui-select_in-select-after"
                                  data-value="{{PolicyInfo.ClaimInfo.ReportTime}}"
                                  data-name="PolicyInfo.ClaimInfo.ReportTime"
                                  bindtap="openDatePickerPopup">
                                {{PolicyInfo.ClaimInfo.ReportTime ? wxsUtil.formatDateTime(PolicyInfo.ClaimInfo.ReportTime) : '请选择'}}
                            </view>
                        </view>
                    </view>
                </view>
            </view>

        </view>
<!--        <block>-->
<!--            <view class="weui-cells__title">查勘图片</view>-->
<!--            <view class="weui-cells weui-cells_after-title">-->
<!--                <view class="weui-cell">-->
<!--                    <view class="weui-cell__bd">-->
<!--                        <view class="weui-uploader">-->
<!--                            <view class="weui-uploader__bd">-->
<!--                                <view class="weui-uploader__files">-->
<!--                                    <view wx:for="{{investigatorImageFiles}}"-->
<!--                                          wx:key="index"-->
<!--                                          data-name="investigatorImageFiles"-->
<!--                                          class="weui-uploader__file image-preview-wrap"-->
<!--                                          bindtap="previewImage">-->
<!--                                        <image class="weui-uploader__img" src="{{item.path}}" mode="aspectFill"/>-->
<!--                                        <van-icon data-name="investigatorImageFiles"-->
<!--                                                  data-id="{{item.id}}"-->
<!--                                                  catchtap="removeImage"-->
<!--                                                  data-index="{{index}}"-->
<!--                                                  name="clear"-->
<!--                                                  custom-class="delete-image-icon">-->
<!--                                        </van-icon>-->
<!--                                    </view>-->
<!--                                </view>-->
<!--                                <view class="weui-uploader__input-box">-->
<!--                                    <view data-name="investigatorImageFiles" class="weui-uploader__input" bindtap="chooseImage"></view>-->
<!--                                </view>-->
<!--                            </view>-->
<!--                        </view>-->
<!--                    </view>-->
<!--                </view>-->
<!--            </view>-->
<!--        </block>-->

        <!-- BUTTON AREA -->
        <view class="button-sp-area"><button type="primary" bindtap="submit">提交 /save</button></view>
        <!-- BUTTON AREA -->
    </view>
    <van-popup show="{{ showAreaPopup }}" position="bottom" overlay="{{ true }}">
        <van-area area-list="{{ areaList }}" value="{{ region }}" bind:confirm="confirmAreaPopup" bind:cancel="closePopup"/>
    </van-popup>
    <van-popup show="{{ showDateTimePopup }}" position="bottom" overlay="{{ true }}">
        <van-datetime-picker type="datetime" value="{{ dateTimeValue }}" bind:confirm="confirmDateTimePopup" bind:cancel="closePopup"/>
    </van-popup>
</view>
